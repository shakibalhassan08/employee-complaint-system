<!DOCTYPE html>
<html>
<head>
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>

<h1>ðŸ›  Admin Dashboard</h1>

<table>
  <thead>
    <tr><th>ID</th><th>Emp</th><th>Problem</th><th>Status</th></tr>
  </thead>
  <tbody id="data"></tbody>
</table>

<script>
async function load() {
  const res = await fetch("/api/complaints");
  const data = await res.json();

  dataEl.innerHTML = data.map(c => `
    <tr>
      <td>${c.complaint_id}</td>
      <td>${c.emp_id}</td>
      <td>${c.problem}</td>
      <td>
        <select onchange="update(${c.complaint_id},this.value)">
          <option ${c.status=="Open"?"selected":""}>Open</option>
          <option ${c.status=="Closed"?"selected":""}>Closed</option>
        </select>
      </td>
    </tr>`).join("");
}

function update(id,status){
  fetch("/api/complaint/"+id,{
    method:"PUT",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({status})
  }).then(load);
}

load();
</script>

</body>
</html>
